(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ad9659b"],{"10f1":function(t,e,a){},"35e9":function(t,e,a){},"4cf6":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"comment-container",attrs:{id:"comment-container"}},[a("form",{staticClass:"fromData",on:{submit:function(e){return e.preventDefault(),t.handleSubmit(t.formData)}}},[a("div",{staticClass:"nickname"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.nickname,expression:"formData.nickname"}],attrs:{type:"text",maxlength:"10",placeholder:"用户昵称"},domProps:{value:t.formData.nickname},on:{input:function(e){e.target.composing||t.$set(t.formData,"nickname",e.target.value)}}}),a("span",[t._v(t._s(t.formData.nickname.length)+"/10")])]),a("div",{staticClass:"error"},[t._v(t._s(t.error.nickname))]),a("div",{staticClass:"content"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.content,expression:"formData.content"}],attrs:{maxlength:"300",rows:"8",cols:"80",placeholder:"输入内容"},domProps:{value:t.formData.content},on:{input:function(e){e.target.composing||t.$set(t.formData,"content",e.target.value)}}}),a("span",[t._v(t._s(t.formData.content.length)+"/300")])]),a("div",{staticClass:"error"},[t._v(t._s(t.error.content))]),a("button",{class:{disable:!t.isDisable},attrs:{type:"submit",disabled:!t.isDisable}},[t._v(" "+t._s(t.isDisable?"提 交":"提 交 中 ...")+" ")])]),a("div",{staticClass:"comment"},[a("h3",{staticClass:"title"},[t._v(t._s(t.title))]),a("span",{staticClass:"number"},[t._v("("+t._s(t.commentCount)+")")]),a("ul",t._l(t.list,(function(e){return a("li",{key:e.id},[a("Avatar",{attrs:{width:50,height:50,url:e.avatar}}),a("div",{staticClass:"data"},[a("div",{staticClass:"nickname"},[t._v(t._s(e.nickname))]),a("div",{staticClass:"createTime"},[t._v(" "+t._s(t.formatDate(e.createDate,!0))+" ")]),a("div",{staticClass:"content"},[t._v(t._s(e.content))])])],1)})),0),a("div",{staticClass:"loading-div"},[t.isLoading?a("Loading"):t._e()],1)])])},r=[],s=a("1da1"),i=(a("96cf"),a("a9e3"),a("77c0")),o=a("ed08"),c=a("781b"),u={components:{Avatar:i["a"],Loading:c["a"]},props:{title:{type:String,default:""},commentCount:{type:Number,default:0},list:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1}},data:function(){return{formData:{nickname:"",content:""},error:{nickname:"",content:""},isDisable:!0}},methods:{formatDate:o["c"],handleSubmit:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.error.nickname=""===t.formData.nickname?"请输入昵称!":"",t.error.content=""===t.formData.content?"请输入内容!":"",t.formData.nickname&&t.formData.content&&(t.isDisable=!1,t.$emit("submit",t.formData,(function(){t.isDisable=!0,t.formData.content=""})));case 3:case"end":return e.stop()}}),e)})))()}}},m=u,l=(a("6cff"),a("2877")),d=Object(l["a"])(m,n,r,!1,null,"10a630a4",null);e["a"]=d.exports},"60a4":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"messageContainer",staticClass:"message",on:{scroll:t.handleScroll}},[t.data?t._e():a("Loading"),t.data?a("Comment",{attrs:{title:"留言板",commentCount:t.data.total,list:t.data.rows,isLoading:t.loadingMore},on:{submit:t.handleSubmit}}):t._e(),t.data?a("div",{staticClass:"no-more-comment"},[t._v(t._s(t.hasMore?"加载更多评论中...":"已没有更多评论"))]):t._e()],1)},r=[],s=a("1da1"),i=(a("99af"),a("96cf"),a("4cf6")),o=a("781b"),c=a("ed08"),u=a("0c6d");function m(){return l.apply(this,arguments)}function l(){return l=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,a,n=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:1,a=n.length>1&&void 0!==n[1]?n[1]:10,t.next=4,u["a"].get("/api/message",{params:{page:e,limit:a}});case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}function d(t){return f.apply(this,arguments)}function f(){return f=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u["a"].post("/api/message",e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}var p=a("eb98"),v={mixins:[Object(p["a"])("messageContainer")],components:{Loading:o["a"],Comment:i["a"]},data:function(){return{data:null,loadingMore:!1,page:1}},computed:{hasMore:function(){if(this.data)return this.data.rows.length<this.data.total}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m(t.page,t.limit);case 2:t.data=e.sent;case 3:case"end":return e.stop()}}),e)})))()},methods:{handleSubmit:function(t,e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,d(t);case 2:r=n.sent,a.data.rows.unshift(r),e(),a.data.total++,Object(c["a"])({content:"感谢留言！",type:"success",container:a.$refs.messageContainer});case 7:case"end":return n.stop()}}),n)})))()},handleScroll:function(){var t=this.$refs.messageContainer,e=t.scrollHeight-(t.clientHeight+t.scrollTop);e<50&&t&&!this.loadingMore&&this.loadMoreComment()},loadMoreComment:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.hasMore){e.next=2;break}return e.abrupt("return");case 2:return t.page++,t.loadingMore=!0,e.next=6,m(t.page,10);case 6:a=e.sent,t.data.rows=t.data.rows.concat(a.rows),t.loadingMore=!1;case 9:case"end":return e.stop()}}),e)})))()}}},h=v,g=(a("cebe"),a("2877")),b=Object(g["a"])(h,n,r,!1,null,"55897d34",null);e["default"]=b.exports},"6cff":function(t,e,a){"use strict";a("35e9")},cebe:function(t,e,a){"use strict";a("10f1")}}]);
//# sourceMappingURL=chunk-5ad9659b.7d499ba4.js.map